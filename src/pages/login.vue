<template>
  <q-layout id="login-layout">
    <q-page-container>
      <q-page id="login-page" class="window-height window-width column justify-center">
        <div id="login-wrapper">
          <div class="login-container shadow-2" :class="{ shake: shakeAnimation }">
            <div class="row justify-center">
              <q-img v-if="logo" :src="logo" spinner-color="white" style="max-width: 250px" />
              <svg v-else class="logo" style="max-width: 250px" viewBox="0 0 107.73501 83.343468">
                <defs id="defs2" />
                <sodipodi:namedview
                  id="base"
                  pagecolor="#ffffff"
                  borderColor="#666666"
                  borderopacity="1.0"
                  inkscape:pageopacity="0.0"
                  inkscape:pageshadow="2"
                  inkscape:zoom="2.8284271"
                  inkscape:cx="147.41017"
                  inkscape:cy="140.84218"
                  inkscape:document-units="mm"
                  inkscape:current-layer="svgg"
                  showgrid="false"
                  showguides="true"
                  inkscape:guide-bbox="true"
                  fit-margin-top="0"
                  fit-margin-left="0"
                  fit-margin-right="0"
                  fit-margin-bottom="0"
                  inkscape:window-width="1846"
                  inkscape:window-height="1057"
                  inkscape:window-x="-8"
                  inkscape:window-y="-8"
                  inkscape:window-maximized="1"
                />
                <metadata id="metadata5">
                  <rdf:RDF>
                    <cc:Work rdf:about>
                      <dc:format>image/svg+xml</dc:format>
                      <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
                      <dc:title />
                    </cc:Work>
                  </rdf:RDF>
                </metadata>
                <g
                  inkscape:label="Ebene 1"
                  inkscape:groupmode="layer"
                  id="layer1"
                  transform="translate(-0.35066595,-5.2847278)"
                >
                  <g id="svgg" transform="matrix(0.26458333,0,0,0.26458333,45.740165,9.9267526)">
                    <g id="rings" style="stroke:#ffc590;stroke-opacity:1">
                      <circle
                        r="109.60159"
                        cy="147.40741"
                        cx="-54.957146"
                        id="path855"
                        style="fill:none;fill-opacity:1;stroke-width:13.98425198;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
                      />
                      <circle
                        style="fill:none;fill-opacity:1;stroke-width:13.98425198;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1"
                        id="circle857"
                        cx="119.04285"
                        cy="147.40741"
                        r="109.60159"
                      />
                    </g>
                    <path
                      d="m 57.258997,256.39935 c 0.061,-0.06 0.127,3.279 0.147,7.422 0.037,7.567 0.148,9.725 0.552,10.699 0.119,0.289 0.136,0.607 0.037,0.706 -0.099,0.1 -0.035,0.356 0.143,0.571 0.179,0.214 0.249,0.585 0.157,0.824 -0.091,0.239 -0.06,0.501 0.069,0.581 0.13,0.08 0.248,0.513 0.263,0.963 0.016,0.45 0.233,1.393 0.484,2.096 0.25,0.703 0.388,1.387 0.306,1.52 -0.082,0.133 -0.013,0.327 0.153,0.43 0.167,0.103 0.227,0.31 0.135,0.46 -0.093,0.15 -0.062,0.273 0.068,0.273 0.131,0.001 0.257,0.298 0.281,0.661 0.057,0.88 0.213,1.508 0.419,1.687 0.136,0.119 0.845,2.008 1.265,3.375 0.092,0.3 0.637,1.704 0.969,2.494 0.102,0.243 0.164,0.54 0.138,0.661 -0.025,0.121 0.093,0.22 0.264,0.22 0.171,0 0.23,0.132 0.13,0.293 -0.1,0.162 -0.042,0.294 0.129,0.294 0.171,0 0.288,0.099 0.26,0.22 -0.085,0.365 0.713,1.834 0.996,1.834 0.145,0 0.192,0.115 0.105,0.257 -0.186,0.301 0.876,1.507 1.945,2.208 0.775,0.508 2.338,0.396 6.044,-0.431 0.694,-0.155 1.766,-0.346 2.382,-0.423 0.615,-0.077 1.599,-0.341 2.185,-0.586 0.585,-0.244 1.098,-0.435 1.139,-0.422 0.112,0.033 0.789,-0.184 2.423,-0.777 0.807,-0.293 1.599,-0.56 1.761,-0.593 0.161,-0.033 1.184,-0.469 2.273,-0.969 1.089,-0.501 2.079,-0.929 2.201,-0.952 0.122,-0.023 0.396,-0.253 0.61,-0.511 0.214,-0.258 0.301,-0.298 0.195,-0.09 -0.169,0.331 1.228,-0.413 3.672,-1.955 0.403,-0.255 0.822,-0.467 0.93,-0.471 0.108,-0.004 0.538,-0.305 0.956,-0.668 0.418,-0.363 0.961,-0.66 1.207,-0.66 0.246,0 0.522,-0.198 0.615,-0.439 0.093,-0.241 0.273,-0.374 0.4,-0.295 0.128,0.079 0.311,-0.062 0.408,-0.314 0.096,-0.251 0.284,-0.389 0.417,-0.307 0.133,0.082 0.427,-0.108 0.654,-0.422 0.226,-0.314 0.561,-0.571 0.744,-0.571 0.183,0 0.674,-0.316 1.091,-0.703 0.417,-0.386 0.83,-0.632 0.917,-0.545 0.086,0.087 0.241003,-0.059 0.343003,-0.324 0.101,-0.265 0.307,-0.482 0.456,-0.482 0.15,0 0.735,-0.463 1.299,-1.027 0.565,-0.565 1.152,-1.028 1.305,-1.028 0.152,0 0.493,-0.33 0.757,-0.733 0.265,-0.404 0.607,-0.734 0.76,-0.734 0.154,0 0.721,-0.429 1.259,-0.954 0.539,-0.524 1.44,-1.317 2.002,-1.761 l 1.022,-0.807 h 9.339 9.34 l 1.502,1.615 c 0.826,0.887 1.632,1.614 1.79,1.614 0.159,0 0.581,0.396 0.939,0.88 0.358,0.484 0.775,0.88 0.926,0.88 0.151,0 0.711,0.437 1.245,0.971 0.534,0.533 1.198,1.057 1.477,1.164 0.279,0.107 0.507,0.331 0.507,0.497 0,0.167 0.198,0.303 0.44,0.303 0.242,0 0.441,0.099 0.442,0.22 0.001,0.121 0.727,0.683 1.613,1.247 0.886,0.565 1.611,1.127 1.612,1.248 0.001,0.121 0.139,0.22 0.308,0.22 0.168,0 0.465,0.134 0.66,0.297 0.754,0.634 2.555,1.73 2.555,1.556 0,-0.101 0.231,0.013 0.514,0.253 0.8,0.679 3.301,2.052 3.301,1.812 0,-0.118 0.208,0.041 0.462,0.354 0.255,0.314 0.377,0.372 0.272,0.13 -0.114,-0.264 -0.016,-0.227 0.245,0.093 0.24,0.293 0.546,0.54 0.682,0.55 0.136,0.009 0.973,0.339 1.861,0.734 0.888,0.395 1.746,0.742 1.908,0.771 0.161,0.029 0.359,0.119 0.44,0.2 0.154,0.154 2.869,1.184 3.375,1.281 0.161,0.031 0.458,0.159 0.66,0.285 0.202,0.126 0.367,0.161 0.367,0.078 0,-0.083 0.542,0.04 1.205,0.274 0.663,0.234 1.323,0.352 1.467,0.263 0.145,-0.089 0.263,-0.03 0.263,0.131 0,0.161 0.231,0.282 0.513,0.27 0.283,-0.013 1.93,0.257 3.661,0.6 3.412,0.677 4.047,0.603 5.257,-0.61 0.833,-0.835 2.638,-4.199 2.387,-4.449 -0.098,-0.098 -0.023,-0.178 0.165,-0.178 0.188,0 0.315,-0.099 0.281,-0.22 -0.034,-0.121 0.158,-0.682 0.427,-1.247 0.487,-1.023 1.326,-3.271 1.534,-4.109 0.061,-0.242 0.136,-0.506 0.167,-0.587 0.031,-0.08 0.042,-0.245 0.022,-0.366 -0.019,-0.121 0.12,-0.22 0.308,-0.22 0.188,0 0.265,-0.078 0.169,-0.174 -0.095,-0.095 0.009,-0.689 0.232,-1.32 0.222,-0.631 0.328,-1.148 0.235,-1.148 -0.093,0 -0.005,-0.198 0.196,-0.44 0.201,-0.242 0.267,-0.44 0.146,-0.44 -0.12,0 -0.071,-0.177 0.109,-0.394 0.179,-0.217 0.267,-0.453 0.194,-0.526 -0.073,-0.073 0.123,-0.951 0.434,-1.953 0.312,-1.001 0.496,-2.005 0.409,-2.232 -0.087,-0.226 -0.023,-0.495 0.142,-0.597 0.165,-0.103 0.226,-0.382 0.134,-0.621 -0.092,-0.239 -0.021,-0.61 0.157,-0.825 0.178,-0.214 0.262,-0.451 0.187,-0.527 -0.075,-0.075 0,-0.987 0.168,-2.027 0.168,-1.04 0.317,-5.093 0.332,-9.007 0.021,-5.754 0.102,-7.116 0.421,-7.116 l -1.542,-8.857 c -0.345,0.325 -0.417,0.29 -0.448,-0.22 -0.058,-0.963 -0.097,-1.133 -0.31,-1.346 -0.11,-0.11 -0.128,-0.385 -0.042,-0.611 0.087,-0.227 0.004,-0.412 -0.184,-0.412 -0.188,0 -0.266,-0.123 -0.173,-0.273 0.093,-0.151 -0.157,-1.141 -0.556,-2.201 -0.4,-1.061 -0.664,-1.928 -0.588,-1.928 0.075,0 -0.052,-0.451 -0.282,-1.003 -0.231,-0.552 -0.342,-1.08 -0.249,-1.174 0.094,-0.094 0.009,-0.171 -0.189,-0.171 -0.197,0 -0.278,-0.132 -0.178,-0.293 0.1,-0.162 0.02,-0.294 -0.178,-0.294 -0.198,0 -0.278,-0.082 -0.177,-0.183 0.101,-0.1 -0.07,-0.678 -0.379,-1.284 -0.309,-0.606 -0.479,-1.184 -0.378,-1.284 0.1,-0.101 0.021,-0.183 -0.177,-0.183 -0.198,0 -0.278,-0.132 -0.178,-0.294 0.099,-0.161 0.041,-0.293 -0.13,-0.293 -0.171,0 -0.311,-0.165 -0.312,-0.367 0,-0.202 -0.291,-0.829 -0.646,-1.394 -0.355,-0.565 -0.652,-1.101 -0.659,-1.191 -0.032,-0.372 -1.577,-1.991 -1.742,-1.825 -0.099,0.098 -0.18,0.058 -0.18,-0.09 0,-0.313 -3.141,-0.504 -3.601,-0.22 -0.171,0.106 -0.685,0.237 -1.142,0.292 -1.971,0.235 -2.492,0.339 -3.278,0.652 -0.458,0.183 -0.953,0.257 -1.101,0.166 -0.148,-0.092 -0.269,-0.06 -0.269,0.071 0,0.131 -0.297,0.266 -0.66,0.3 -1.022,0.098 -1.486,0.229 -2.201,0.622 -0.363,0.2 -0.66,0.297 -0.66,0.217 0,-0.081 -0.595,0.108 -1.321,0.419 -0.726,0.311 -1.321,0.507 -1.321,0.434 0,-0.072 -0.825,0.274 -1.834,0.769 -1.009,0.496 -2.296,1.121 -2.861,1.39 -0.565,0.269 -1.108,0.599 -1.207,0.734 -0.099,0.134 -0.231,0.221 -0.293,0.193 -0.237,-0.109 -1.728,0.694 -1.728,0.929 0,0.136 -0.099,0.22 -0.22,0.188 -0.386,-0.102 -1.541,0.382 -1.541,0.645 0,0.14 -0.265,0.338 -0.589,0.441 -0.323,0.103 -0.984,0.52 -1.467,0.926 -0.483,0.407 -0.879,0.663 -0.879,0.57 0,-0.161 -0.805,0.44 -1.612,1.204 -0.205,0.194 -0.451,0.275 -0.547,0.178 -0.096,-0.096 -0.258,0.042 -0.359,0.306 -0.102,0.264 -0.289,0.416 -0.417,0.337 -0.127,-0.079 -0.31,0.063 -0.407,0.314 -0.096,0.251 -0.295,0.384 -0.44,0.294 -0.146,-0.09 -0.341,0.033 -0.433,0.274 -0.093,0.242 -0.293,0.439 -0.446,0.439 -0.28,0 -1.266,0.757 -2.58,1.981 -0.39,0.363 -0.832,0.66 -0.983,0.66 -0.15,0 -0.489,0.33 -0.754,0.734 -0.264,0.403 -0.603,0.734 -0.752,0.734 -0.149,0 -0.788,0.495 -1.42,1.1 -2.806,2.688 -1.481,2.421 -12.006,2.421 h -9.342 l -1.345,-1.247 c -0.74,-0.686 -1.781,-1.616 -2.313,-2.066 -0.532,-0.451 -1.529,-1.342 -2.215,-1.981 -0.687,-0.639 -1.384,-1.162 -1.55,-1.162 -0.167,0 -0.379,-0.198 -0.472,-0.44 -0.093,-0.243 -0.357,-0.441 -0.587,-0.441 -0.229003,0 -0.494003,-0.198 -0.587003,-0.44 -0.092,-0.242 -0.352,-0.44 -0.577,-0.44 -0.225,0 -0.409,-0.101 -0.409,-0.224 0,-0.124 -0.528,-0.551 -1.174,-0.95 -0.646,-0.399 -1.174,-0.834 -1.174,-0.967 0,-0.133 -0.132,-0.16 -0.293,-0.06 -0.162,0.1 -0.294,0.041 -0.294,-0.129 0,-0.171 -0.198,-0.311 -0.44,-0.311 -0.242,0 -0.44,-0.154 -0.44,-0.343 0,-0.188 -0.08,-0.262 -0.178,-0.164 -0.098,0.098 -0.519,-0.137 -0.934,-0.522 -0.416,-0.385 -0.849,-0.643 -0.963,-0.573 -0.113,0.07 -0.37,-0.069 -0.569,-0.309 -0.2,-0.24 -0.52,-0.437 -0.712,-0.437 -0.192,0 -0.638,-0.269 -0.991,-0.598 -0.353,-0.329 -0.642,-0.518 -0.642,-0.419 0,0.099 -0.71,-0.226 -1.577,-0.722 -0.867,-0.496 -1.785,-0.902 -2.039,-0.902 -0.255,0 -0.598,-0.231 -0.763,-0.514 -0.164,-0.282 -0.303,-0.426 -0.308,-0.319 -0.005,0.107 -1.098,-0.265 -2.43,-0.827 -1.331,-0.561 -2.699,-1.077 -3.039,-1.146 -0.34,-0.069 -1.153,-0.314 -1.807,-0.545 -0.655,-0.231 -1.268,-0.342 -1.364,-0.246 -0.095,0.095 -0.173,0.005 -0.173,-0.201 0,-0.208 -0.191,-0.3 -0.431,-0.208 -0.237,0.091 -0.51,0.037 -0.607,-0.12 -0.097,-0.157 -0.299,-0.21 -0.449,-0.117 -0.151,0.093 -0.436,0.068 -0.635,-0.055 -0.199,-0.123 -0.562,-0.244 -0.807,-0.27 -0.245,-0.026 -1.238,-0.196 -2.207,-0.379 -2.646,-0.5 -6.64,0.018 -5.893,0.765 0.094,0.095 -0.047,0.414 -0.314,0.71 -0.268,0.295 -0.398,0.537 -0.291,0.537 0.108,0 -0.128,0.514 -0.524,1.142 -0.397,0.628 -0.641,1.222 -0.542,1.32 0.098,0.099 0.017,0.179 -0.181,0.179 -0.198,0 -0.278,0.132 -0.178,0.294 0.1,0.161 0.041,0.293 -0.13,0.293 -0.171,0 -0.28,0.099 -0.243,0.22 0.037,0.121 -0.183,0.815 -0.488,1.541 -0.306,0.726 -0.595,1.453 -0.643,1.614 -0.358,1.206 -1.125,3.255 -1.262,3.375 -0.168,0.146 -0.322,0.852 -0.4,1.834 -0.023,0.283 -0.145,0.514 -0.272,0.514 -0.127,0 -0.215,0.099 -0.196,0.22 0.019,0.121 0.004,0.352 -0.034,0.513 -0.037,0.162 -0.088,0.426 -0.113,0.587"
                      id="suitfly"
                      inkscape:connector-curvature="0"
                      style="fill:#7871c2;fill-opacity:1;fill-rule:evenodd;stroke:none"
                      sodipodi:nodetypes="cccccccccsccccccccscscscccccccccssccssssccscscccssscsccccccssscsssscsscscsccccscscssscsccccssccccsscssscscccsccsccccscsccsccscscscscscsccsccccsccssscsccscsccscccccccscscscsccccscscsssscsssscccssssscscscsscscsscccsccscssccccsscc"
                    />
                    <path
                      d="m -86.138409,-13.136082 c -6.363,6.8139963 -6.843,7.3289963 -11.00101,11.7949964 -2.245003,2.4109999 -4.578001,4.9029999 -5.183001,5.5379999 -0.605,0.634 -1.101,1.271 -1.101,1.414 0,0.15 5.962001,0.229 13.983011,0.185 l 13.983,-0.076 2.117,-4.549 c 1.164,-2.5019999 3.336,-7.19 4.82801,-10.417996 1.491,-3.2280003 2.896,-6.2530003 3.122,-6.7220003 0.227,-0.468 0.412,-0.897 0.412,-0.953 0,-0.056 -3.944,-0.102 -8.76501,-0.102 h -8.764 l -3.631,3.888 m 24.96901,0.4 c -1.126,2.367 -2.048,4.3470003 -2.048,4.4000003 0,0.053 -1.453,3.190996 -3.228,6.9729961 -1.776,3.7819999 -3.22901,6.9559999 -3.22901,7.0529999 0,0.097 6.80201,0.177 15.11401,0.177 8.313,0 15.114,-0.08 15.114,-0.178 0,-0.097 -1.305,-2.97 -2.9,-6.38299993 -1.595,-3.41300007 -3.948,-8.44999607 -5.228,-11.19399637 l -2.328,-4.989 -4.609,-0.081 -4.609,-0.081 -2.049,4.303 m 18.034,-2.014 c 0.542,1.251 1.767,3.926 2.724,5.9430003 0.956,2.017996 2.06,4.387996 2.452,5.266996 0.393,0.88 1.522,3.32300007 2.509,5.43 l 1.796,3.83 13.978,0.076 c 8.507,0.047 13.9790004,-0.031 13.9790004,-0.197 0,-0.151 -0.368,-0.647 -0.818,-1.104 -0.449,-0.456 -3.5130004,-3.735 -6.8080004,-7.286 -3.295,-3.551 -7.634,-8.2059963 -9.643,-10.3449963 l -3.653,-3.888 h -8.75 -8.75 l 0.984,2.274 m -60.288021,26.224996 c 0,0.179 2.25678,3.324495 4.799778,6.017495 2.542,2.692 6.33801,6.739 8.43501,8.991 2.097,2.253 4.635,4.961 5.64,6.019 l 1.828,1.922 56.067291,-0.013 2.263942,-2.711495 c 1.002,-1.053 3.538,-3.759 5.635,-6.012 2.097,-2.252 5.893,-6.299 8.435,-8.991 2.5420004,-2.693 4.6220004,-5.043 4.6220004,-5.222 0,-0.454 -27.4660004,-0.464 -27.7470004,-0.009 -0.108,0.174 -0.9,2.386 -1.761,4.915 -0.86,2.53 -2.339,6.844 -3.286,9.588 l -1.721,4.989 -1.158,0.084 c -0.637,0.047 -1.846,-0.019 -2.688,-0.146 l -1.53,-0.231 1.183,-3.375 c 0.651,-1.856 1.627,-4.696 2.17,-6.31 0.543,-1.614 1.458,-4.306 2.034,-5.982 0.577,-1.676 1.048,-3.228 1.048,-3.448 0,-0.334 -2.58,-0.401 -15.407,-0.401 -12.827,0 -15.40701,0.067 -15.40701,0.401 0,0.22 0.472,1.772 1.04801,3.448 0.576,1.676 1.492,4.368 2.035,5.982 0.542,1.614 1.519,4.454 2.17,6.31 l 1.183,3.375 -1.355,0.234 c -0.745,0.129 -1.955,0.195 -2.688,0.147 l -1.333,-0.088 -1.72201,-4.989 c -0.946,-2.744 -2.425,-7.058 -3.286,-9.588 -0.861,-2.529 -1.653,-4.741 -1.76,-4.915 -0.281,-0.455 -27.748011,-0.445 -27.748011,0.009"
                      id="diamond"
                      inkscape:connector-curvature="0"
                      style="fill:#ff847c;fill-opacity:1;fill-rule:evenodd;stroke:#ffc590;stroke-opacity:0"
                      sodipodi:nodetypes="cccscccccsscccscsssscccccccccccscsccccccccccccccsccccccccscsssscccccccccc"
                    />
                  </g>
                </g>
              </svg>
            </div>
            <div class="row font-pretty text-primary" style="margin-top: 1em">
              <div class="full-width text-h2 text-center">{{ coupleName }}</div>
            </div>
            <div class="row text-center" style="margin-top: 3em">
              <div class="text-center full-width text-h6 login-text-color">{{ title || "" }}</div>
            </div>
            <div class="row text-center">
              <div class="text-center full-width login-text-color">{{ subtitle || "" }}:</div>
            </div>
            <div class="row" style="margin-top: 1em">
              <q-input
                color="secondary"
                v-model="code"
                @keydown.enter.prevent="login()"
                :label="$t('code')"
                class="full-width"
              ></q-input>
            </div>
            <div class="row" style="margin-top: 1.5em">
              <q-btn
                unelevated
                outline
                rounded
                color="white"
                text-color="primary"
                size="lg"
                class="full-width"
                :label="$t('login')"
                @click="login()"
                :loading="loadingLogin"
              />
            </div>
          </div>
        </div>
        <div class="q-mt-sm text-center">
          <a
            :href="adminPanelLink"
            target="_blank"
            class="link link-admin"
          >{{ $t('Administration') }}</a>
        </div>
      </q-page>
    </q-page-container>
  </q-layout>
</template>
<!-- Notice lang="scss" -->
<style lang="scss">
#login-layout {
  background: #eeeeee;
}
#login-page {
  align-items: center;
}

.link-admin {
  color: rgba(0, 0, 0, 0.3);
}
.login-container {
  padding: 2em;

  width: 100%;
  min-width: 400px;
  max-width: 450px;

  background: white;
  border: rgba(0, 0, 0, 0.25);
  border-radius: 5px;
}
#waring-date {
  //background-color: #e67e22;
  //color: #ffffff;
  border-radius: 4px;
  border: rgba(0, 0, 0, 0.25);
  font-weight: bold;
}
@media (max-width: 500px) {
  #login-layout {
    background: #ffffff;
  }
  #login-page {
    align-items: unset;
  }
  #login-wrapper {
    width: 100%;
  }
  .login-container {
    min-width: unset;
    max-width: unset;

    border: unset;
    box-shadow: unset;
  }
}
.shake {
  animation: shake 0.82s cubic-bezier(0.36, 0.07, 0.19, 0.97) both;
  transform: translate3d(0, 0, 0);
}
@keyframes shake {
  10%,
  90% {
    transform: translate3d(-1px, 0, 0);
  }
  20%,
  80% {
    transform: translate3d(2px, 0, 0);
  }
  30%,
  50%,
  70% {
    transform: translate3d(-4px, 0, 0);
  }
  40%,
  60% {
    transform: translate3d(4px, 0, 0);
  }
}
</style>
<script>
import { mapGetters, mapState } from "vuex";
import { loadAfterSignIn } from "../utils/data-loader";
import { getErrMessage } from "../utils/error-helper";

export default {
  name: "Login",
  data() {
    return {
      code: "",
      loadingLogin: false,
      notifyMessage: undefined,
      shakeAnimation: false,
      adminPanelLink: process.env.adminPanel
    };
  },
  computed: {
    ...mapState({
      title: (state) => state.basedata.signIn.title,
      subtitle: (state) => state.basedata.signIn.subtitle
    }),
    ...mapGetters({
      coupleName: "basedata/coupleName",
      logo: "basedata/logoSmallURL"
    })
  },
  created() {
    // when the user is logged in or no login required, we will reroute
    if (
      this.$store.getters["user/isLoggedIn"] ||
      !this.$store.getters["basedata/signInRequired"]
    ) {
      this.$router.push("/");
    }
  },

  methods: {
    async login() {
      const code = this.code;
      if (code === "") {
        return;
      }

      this.loadingLogin = true;
      try {
        await this.$store.dispatch("user/login", code.toLowerCase());
        await loadAfterSignIn({ store: this.$store });
        this.$router.push("/");
      } catch (err) {
        this.shakeAnimation = true;
        setTimeout(() => (this.shakeAnimation = false), 1000);

        let errText = "";
        if (err.isAxiosError && err.response.status === 400) {
          errText = this.$t("loginError");
        } else {
          errText = getErrMessage(err, this.$t);
        }
        this.closeNotifyMessage();
        this.notifyMessage = this.$q.notify({
          color: "negative",
          timeout: 5000,
          icon: "error",
          position: "bottom",
          message: errText,
          multiLine: true
        });
      } finally {
        this.loadingLogin = false;
      }
    },
    closeNotifyMessage() {
      if (this.notifyMessage) {
        this.notifyMessage();
      }
    }
  }
};
</script>
